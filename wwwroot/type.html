<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" />
    <link rel="stylesheet" href="css/Site.css" />
    <link rel="stylesheet" href="css/zy.all.css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" />
    <link rel="stylesheet" href="css/amazeui.min.css" />
    <link rel="stylesheet" href="css/admin.css" />

    <style>
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            display: none;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            width: 50%;
            padding: 20px;
        }

        .modal-header {
            font-weight: bold;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .form-group {
            margin-bottom: 10px;
        }

            .form-group label {
                display: inline-block;
                width: 150px;
                font-weight: bold;
            }

            .form-group input[type="text"] {
                width: 75%;
                padding: 5px;
            }

        .button-container {
            text-align: center;
        }

            .button-container button {
                padding: 10px 20px;
                font-size: 16px;
                background-color: #4CAF50;
                color: #fff;
                border: none;
                cursor: pointer;
            }

                .button-container button:hover {
                    background-color: #3E8E41;
                }
    </style>
    </head>
    <body>
        <div class="dvcontent">

            <div>
                <!--tab start-->
                <div class="tabs">
                    <div class="hd">
                        <ul style="">
                            <li style="box-sizing: initial;-webkit-box-sizing: initial;" class="on">查看分类</li>
                            <li class="" style="box-sizing: initial;-webkit-box-sizing: initial;">添加分类</li>
                        </ul>
                    </div>
                    <div class="bd">
                        <ul style="display: block;padding: 20px;">
                            <li>
                                <!--分页显示角色信息 start-->
                                <div id="dv1">
                                    <table class="table" id="tbRecord">
                                        <thead>
                                            <tr>
                                                <th>分类编号</th>
                                                <th>分类名称</th>
                                                <th>分类描述</th>
                                                <th>备注</th>
                                                <th>编辑</th>
                                                <th>删除</th>
                                            </tr>
                                        </thead>
                                        <tbody id="data-body">
                                            <!-- 数据将显示在这里 -->
                                        </tbody>

                                    </table>
                                </div>
                                <!--分页显示角色信息 end-->
                            </li>
                        </ul>
                        <ul class="theme-popbod dform" style="display: none;">
                            <div class="am-cf admin-main" style="padding-top: 0px;">
                                <!-- content start -->

                                <div class="am-cf admin-main" style="padding-top: 0px;">
                                    <!-- content start -->
                                    <div class="admin-content">
                                        <div class="admin-content-body">

                                            <div class="am-g">
                                                <div class="am-u-sm-12 am-u-md-4 am-u-md-push-8">

                                                </div>
                                                <div class="am-u-sm-12 am-u-md-8 am-u-md-pull-4"
                                                     style="padding-top: 30px;">
                                                    <form class="am-form am-form-horizontal"
                                                          action="user/addUser1Submit.action" method="post">

                                                        <div class="am-form-group">
                                                            <label for="user-name" class="am-u-sm-3 am-form-label">
                                                                分类名称
                                                            </label>
                                                            <div class="am-u-sm-9">
                                                                <input type="text" id="user-name" required
                                                                       placeholder="分类名称" name="name">
                                                                <small>10字以内...</small>
                                                            </div>
                                                        </div>
                                                        <div class="am-form-group">
                                                            <label for="user-intro" class="am-u-sm-3 am-form-label">
                                                                分类描述
                                                            </label>
                                                            <div class="am-u-sm-9">
                                                                <textarea class="" rows="5" id="user-intro1" name="remark"
                                                                          placeholder="输入描述"></textarea>
                                                                <small>250字以内...</small>
                                                            </div>
                                                        </div>
                                                        <div class="am-form-group">
                                                            <label for="user-intro" class="am-u-sm-3 am-form-label">
                                                                备注
                                                            </label>
                                                            <div class="am-u-sm-9">
                                                                <textarea class="" rows="5" id="user-intro" name="remark"
                                                                          placeholder="输入备注"></textarea>
                                                                <small>250字以内...</small>
                                                            </div>
                                                        </div>
                                                        <div class="am-form-group">
                                                            <div class="am-u-sm-9 am-u-sm-push-3">
                                                                <input type="submit" onclick=" getInputValue()" class="am-btn am-btn-success" value="添加分类" />
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                    <!-- content end -->
                                </div>
                              </div>  <!-- end-->
                        </ul>
                    </div>
                </div>
                <!--tab end-->

            </div>

            <div class="modal">
                <div class="modal-content">
                    <div class="modal-header">编辑分类</div>
                    <form>
                        <div class="form-group">
                            <label for="edit-number">分类编号：</label>
                            <input type="text" id="edit-number" name="number" readonly>
                        </div>
                        <div class="form-group">
                            <label for="edit-name">分类名称：</label>
                            <input type="text" id="edit-name" name="name">
                        </div>
                        <div class="form-group">
                            <label for="edit-description">分类描述：</label>
                            <input type="text" id="edit-description" name="description">
                        </div>
                        <div class="form-group">
                            <label for="edit-remark">备注：</label>
                            <input type="text" id="edit-remark" name="remark">
                        </div>
                        <div class="button-container">
                            <button type="button" id="edit-submit">确定</button>
                        </div>
                    </form>
                </div>
            </div>

            <script src="js/jquery-1.7.2.min.js" type="text/javascript"></script>
            <script src="js/plugs/Jqueryplugs.js" type="text/javascript"></script>
            <script src="js/_layout.js"></script>
            <script src="js/plugs/jquery.SuperSlide.source.js"></script>
            <script>

                // 页面加载时执行函数
                window.onload = function R() {
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", "WeatherForecastController/api/categories", true);
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            // 请求成功处理逻辑
                            var responseData = JSON.parse(xhr.responseText);
                            var tableBody = document.getElementById("data-body");
                            for (var i = 0; i < responseData.length; i++) {
                                var row = document.createElement("tr");

                                var numberCell = document.createElement("td");
                                numberCell.textContent = responseData[i]["Id"];
                                row.appendChild(numberCell);

                                var nameCell = document.createElement("td");
                                nameCell.textContent = responseData[i]["Name"];
                                row.appendChild(nameCell);

                                var descriptionCell = document.createElement("td");
                                descriptionCell.textContent = responseData[i]["描述"];
                                row.appendChild(descriptionCell);

                                var remarkCell = document.createElement("td");
                                remarkCell.textContent = responseData[i][" Remark"];
                                row.appendChild(remarkCell);

                                var editCell = document.createElement("td");
                                var editButton = document.createElement("button");
                                editButton.textContent = "编辑";
                                editButton.addEventListener("click", function () {
                                    // 编辑按钮的点击逻辑
                                    var currentRow = this.parentNode.parentNode;
                                    var number = currentRow.cells[0].textContent;
                                    var name = currentRow.cells[1].textContent;
                                    var description = currentRow.cells[2].textContent;
                                    var remark = currentRow.cells[3].textContent;
                                    // 执行编辑相关的操作
                                    // 将当前数据填充到编辑框中
                                    document.getElementById("edit-number").value = number;
                                    document.getElementById("edit-name").value = name;
                                    document.getElementById("edit-description").value = description;
                                    document.getElementById("edit-remark").value = remark;

                                    // 显示编辑框
                                    var modal = document.querySelector(".modal");
                                    modal.style.display = "block";

                                });
                                editCell.appendChild(editButton);
                                row.appendChild(editCell);

                                var deleteCell = document.createElement("td");
                                var deleteButton = document.createElement("button");
                                deleteButton.textContent = "删除";
                                deleteCell.appendChild(deleteButton);
                                var currentRow = this.parentNode.parentNode;
                                var number = currentRow.cells[0].textContent;
                                editButton.addEventListener("click", btn_delete(number))
                                row.appendChild(deleteCell);

                                tableBody.appendChild(row);
                            }
                        }
                    };
                    xhr.send();
                };

                // 添加编辑框的确定按钮的点击事件
                var submitButton = document.getElementById("edit-submit");
                submitButton.addEventListener("click", function () {
                    // 获取编辑框中填写的数据
                    var number = document.getElementById("edit-number").value;
                    var name = document.getElementById("edit-name").value;
                    var description = document.getElementById("edit-description").value;
                    var remark = document.getElementById("edit-remark").value;

                    // 构造请求数据
                    var requestData = {
                        "Id": number,
                        "Name": name,
                        "Description": description,
                        "Remark": remark
                    };

                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", " WeatherForecastController/api/categories/save", true);
                    xhr.setRequestHeader("Content-type", "application/json");
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            // 请求成功处理逻辑
                            swal(" 修改成功");
                            R();
                            // 隐藏编辑框
                            var modal = document.querySelector(".modal");
                            modal.style.display = "none";
                        }
                    };
                    xhr.send(JSON.stringify(requestData));
                },

                function getInputValue() {
                    var T = {
                        Name: document.getElementById("user-name").value,
                        Description: document.getElementById("user-intro").value,
                        Remark: document.getElementById("user-intro1").value
                    }
                    if (!input) return;
                    var xhr = new XMLHttpRequest();
                    xhr.open("POST", "WeatherForecastController/api/categories1", true);
                    xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                    xhr.onreadystatechange = function () {
                        if (xhr.readyState === 4 && xhr.status === 200) {
                            R();
                        }
                    };
                    xhr.send(T);
                }
               
                var num = 1;
                $(function () {

                    $(".tabs").slide({ trigger: "click" });

                });



                var btn_delete = function (id) {
                    $.jq_Confirm({
                        message: "您确定要删除吗?",
                        btnOkClick: function () {
                            $.ajax({
                                type: "post",
                                url: "WeatherForecastController /api/categories2",
                                data: { id: id },
                                success: function (data) {
                                    if (data > 0) {
                                        $.jq_Alert({
                                            message: "删除成功",
                                            btnOkClick: function () {
                                                R();
                                            }
                                        });
                                    }
                                }
                            });
                        }
                    });
                }
            </script>

        </div>
    </body>

</html>